<html>
<head></head>
<body>
<label for="opusurl">URL to your opus:</label>
<input type="url" id="opusurl" name="opusurl"> 
<button id="b" onclick="sendMessage()">clicky</button>
<script type="text/javascript" src="feeddecoder.js"></script>
<script>
    console.log('sup')

    const worker = new Worker('decodeworker.js')
    console.log(worker)


    function sendMessage() {
        worker.onmessage = async function (chunksMessage) {
            console.log('worker sent us chunks', chunksMessage)
            const chunks = chunksMessage.data
            const FD = FeedDecoder.default
            const decoder = new FD()
            console.log(decoder)

            const buf = await decoder._onNewMessageChunks(chunks)
            console.log(buf)

            decoder._playBuffer(buf)
        }
        worker.postMessage({url: document.getElementById('opusurl').value || 'https://pkg.storyboardtesting.com/audio/poppclip.opus'})
    }

</script>
</body>
</html>
